# DevTools â€” Part 1 of 2: fresh_produce_jina + API Key
#
# Where to run: Kibana â†’ Dev Tools â†’ Console â†’ http://localhost:5601
# Credentials:  elastic user + password generated by start-local
#
# Run this file FIRST.
# Then run: devtools_app_logs_synthetic.md
#
# Prerequisites:
#   - Elasticsearch 9.x running locally (Docker)
#   - JINA API Key: https://jina.ai/embeddings
#
# How to use:
#   Copy each block into the console and click â–¶ï¸ Run (or Ctrl+Enter)
#   Follow the order: Step 1 â†’ 2 â†’ 3 â†’ 4 â†’ 5
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 1 â€” Create JINA inference endpoint
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Registers JINA as an embedding provider in Elasticsearch.
# From this point on, ES calls JINA automatically at index and query time.
#
# âš ï¸ Replace YOUR_JINA_API_KEY with your key (starts with "jina_...")

PUT _inference/text_embedding/jina-embeddings-v3
{
  "service": "jinaai",
  "service_settings": {
    "api_key": "YOUR_JINA_API_KEY",
    "model_id": "jina-embeddings-v3"
  }
}


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 2 â€” Create the index with mapping
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# The `semantic_text` field handles semantic search.
# It delegates embedding generation to the endpoint created in Step 1.

PUT fresh_produce_jina
{
  "settings": {
    "number_of_replicas": 0,
    "refresh_interval": "1s"
  },
  "mappings": {
    "properties": {
      "id":             { "type": "integer" },
      "name":           { "type": "text" },
      "category":       { "type": "keyword" },
      "description":    { "type": "text" },
      "price":          { "type": "float" },
      "discount_price": { "type": "float" },
      "on_sale":        { "type": "boolean" },
      "stock_kg":       { "type": "integer" },
      "image_url":      { "type": "keyword" },
      "updated_at":     { "type": "date" },
      "semantic_text": {
        "type": "semantic_text",
        "inference_id": "jina-embeddings-v3"
      }
    }
  }
}


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 3 â€” Bulk index documents
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NDJSON format: one action line + one document line.
# The `semantic_text` field in each doc is sent to JINA to generate
# the embedding, which is stored inside Elasticsearch.

POST fresh_produce_jina/_bulk
{ "index": { "_id": "1" } }
{ "id": 1, "name": "Cherry Tomatoes", "price": 12.5, "discount_price": null, "stock_kg": 85, "category": "vegetables", "description": "Sweet cherry tomatoes, perfect for salads and snacking. Locally grown and fresh.", "on_sale": false, "image_url": "https://imgur.com/w04NNaB.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Cherry Tomatoes Sweet cherry tomatoes, perfect for salads and snacking. Locally grown and fresh. vegetables" }
{ "index": { "_id": "2" } }
{ "id": 2, "name": "Organic Spinach", "price": 11.2, "discount_price": 8.99, "stock_kg": 55, "category": "vegetables", "description": "Fresh organic spinach, rich in iron and nutrients. Great for smoothies and cooking.", "on_sale": true, "image_url": "https://imgur.com/Qpchv67.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Organic Spinach Fresh organic spinach, rich in iron and nutrients. Great for smoothies and cooking. vegetables" }
{ "index": { "_id": "3" } }
{ "id": 3, "name": "Fresh Broccoli", "price": 8.9, "discount_price": null, "stock_kg": 65, "category": "vegetables", "description": "Nutritious green broccoli, rich in vitamins and fiber. Perfect for steaming or stir-frying.", "on_sale": false, "image_url": "https://imgur.com/hTU3nNa.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Fresh Broccoli Nutritious green broccoli, rich in vitamins and fiber. Perfect for steaming or stir-frying. vegetables" }
{ "index": { "_id": "4" } }
{ "id": 4, "name": "Yellow Bell Pepper", "price": 14.5, "discount_price": 11.99, "stock_kg": 40, "category": "vegetables", "description": "Vibrant yellow bell pepper, sweet and crunchy. Rich in vitamin C and antioxidants.", "on_sale": true, "image_url": "https://imgur.com/a6v6ej8.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Yellow Bell Pepper Vibrant yellow bell pepper, sweet and crunchy. Rich in vitamin C and antioxidants. vegetables" }
{ "index": { "_id": "5" } }
{ "id": 5, "name": "Purple Onions", "price": 6.75, "discount_price": null, "stock_kg": 90, "category": "vegetables", "description": "Mild and sweet purple onions, great for salads and grilling. Adds beautiful color to dishes.", "on_sale": false, "image_url": "https://imgur.com/Aos2og5.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Purple Onions Mild and sweet purple onions, great for salads and grilling. Adds beautiful color to dishes. vegetables" }
{ "index": { "_id": "6" } }
{ "id": 6, "name": "Ripe Avocados", "price": 18.9, "discount_price": 15.99, "stock_kg": 30, "category": "fruits", "description": "Creamy ripe avocados, perfect for guacamole and toast. Rich in healthy fats.", "on_sale": true, "image_url": "https://i.imgur.com/3cseQO9.png", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Ripe Avocados Creamy ripe avocados, perfect for guacamole and toast. Rich in healthy fats. fruits" }
{ "index": { "_id": "7" } }
{ "id": 7, "name": "Sweet Carrots", "price": 7.5, "discount_price": null, "stock_kg": 70, "category": "vegetables", "description": "Sweet and crunchy orange carrots. High in beta-carotene and vitamin A.", "on_sale": false, "image_url": "https://imgur.com/jH4SbhK.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Sweet Carrots Sweet and crunchy orange carrots. High in beta-carotene and vitamin A. vegetables" }
{ "index": { "_id": "8" } }
{ "id": 8, "name": "Purple Carrots", "price": 9.8, "discount_price": null, "stock_kg": 48, "category": "vegetables", "description": "Unique purple carrots, sweet and antioxidant-rich. Great roasted or raw in salads.", "on_sale": false, "image_url": "https://imgur.com/jH4SbhK.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Purple Carrots Unique purple carrots, sweet and antioxidant-rich. Great roasted or raw in salads. vegetables" }
{ "index": { "_id": "9" } }
{ "id": 9, "name": "Green Lettuce", "price": 5.99, "discount_price": null, "stock_kg": 60, "category": "vegetables", "description": "Crisp green lettuce, perfect for fresh salads. Low calorie and refreshing.", "on_sale": false, "image_url": "https://imgur.com/Z5klm1s.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Green Lettuce Crisp green lettuce, perfect for fresh salads. Low calorie and refreshing. vegetables" }
{ "index": { "_id": "10" } }
{ "id": 10, "name": "Seedless Watermelon", "price": 22.5, "discount_price": 19.99, "stock_kg": 120, "category": "fruits", "description": "Sweet and juicy seedless watermelon. Perfect for hot days, rich in hydration.", "on_sale": true, "image_url": "https://imgur.com/v1yJ0Zn.jpg", "updated_at": "2026-02-08T10:00:00Z", "semantic_text": "Seedless Watermelon Sweet and juicy seedless watermelon. Perfect for hot days, rich in hydration. fruits" }


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 4 â€” Verify (optional but recommended)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GET fresh_produce_jina/_count

GET fresh_produce_jina/_search
{
  "query": {
    "semantic": {
      "field": "semantic_text",
      "query": "healthy leafy greens"
    }
  },
  "size": 3,
  "_source": ["name", "category", "price"]
}


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 5 â€” Create read-only API Key for OpenClaw
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# This key allows:
#   âœ… Read and search ALL indices (for free exploration in OpenClaw)
#   âœ… View index metadata (mappings, settings)
#   âœ… Monitor the cluster (health, stats)
#
# Does NOT allow:
#   âŒ Write or delete documents
#   âŒ Create or delete indices
#   âŒ Change cluster settings

POST /_security/api_key
{
  "name": "openclaw-readonly-all-indices",
  "role_descriptors": {
    "elasticsearch_explorer": {
      "indices": [
        {
          "names": ["*"],
          "privileges": ["read", "view_index_metadata", "monitor"]
        }
      ],
      "cluster": ["monitor"]
    }
  }
}

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”‘ The response will look like this:
#
# {
#   "id":       "abc123...",
#   "name":     "openclaw-readonly-all-indices",
#   "api_key":  "XXXXXXXXXXXXXXXXX",
#   "encoded":  "YYYYYYYYYYYYYYY"   â† use this in OpenClaw (.env file)
# }
#
# âš ï¸ Save the "encoded" value now â€” it cannot be retrieved later.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
